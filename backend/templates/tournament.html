<!DOCTYPE html>
<html>
<head>
    <title>Tournament Report</title>
</head>
<body>
<h1>Tournament: {{ tournament.name }}</h1>
<p>Start date: {{ tournament.start_datetime }}</p>
<p>End date: {{ tournament.end_datetime if tournament.end_datetime is not none else 'N/A' }}</p>

{% if tournament.players|length > 0 %}
<h2>Players:</h2>
<ul>
    {% for player in tournament.players|sort(attribute='last_name') %}
    <li>
        <p>Name: {{ player.first_name }} {{ player.last_name }}</p>
        <p>Chess ID: {{ player.chess_id }}</p>
        <p>Elo: {{ player.elo }}</p>
    </li>
    {% endfor %}
</ul>
{% endif %}

{% if tournament.rounds|length > 0 %}
<h2>Rounds:</h2>
<ul>
    {% for round in tournament.rounds %}
    <li>
        <p>Round number: {{ round.round_number }}</p>
        <p>Status: {{ round.status }}</p>
        <p>Start datetime: {{ round.start_datetime }}</p>
        <p>End datetime: {{ round.end_datetime if round.end_datetime is not none else 'N/A' }}</p>

        {% if round.games %}
        <h3>Games:</h3>
        <ul>
            {% for game in round.games %}
            <li>
                <p>Game ID: {{ game.id }}</p>
                <p>
                    Player 1: {{ game.p1_id }}:
                    {% if game.p1_score == 1.0 %}WON
                    {% elif game.p1_score == 0.0 %}LOST
                    {% elif game.p1_score == 0.5 %}TIE
                    {% endif %}
                </p>
                <p>
                    Player 2: {{ game.p2_id }}: {% if game.p2_score == 1.0 %}WON
                    {% elif game.p2_score == 0.0 %}LOST
                    {% elif game.p2_score == 0.5 %}TIE
                    {% endif %}
                </p>
            </li>
            {% endfor %}
        </ul>
        {% endif %}
    </li>
    {% endfor %}
</ul>
{% endif %}
</body>
</html>
